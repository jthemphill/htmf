{"version":3,"file":"bot.worker-31b040de.js","sources":["../../pkg/htmf_wasm.js","../src/constants.ts","../src/Bot.ts","../src/bot.worker.ts"],"sourcesContent":["let wasm;\n\nconst cachedTextDecoder = (typeof TextDecoder !== 'undefined' ? new TextDecoder('utf-8', { ignoreBOM: true, fatal: true }) : { decode: () => { throw Error('TextDecoder not available') } } );\n\nif (typeof TextDecoder !== 'undefined') { cachedTextDecoder.decode(); };\n\nlet cachedUint8Memory0 = null;\n\nfunction getUint8Memory0() {\n    if (cachedUint8Memory0 === null || cachedUint8Memory0.byteLength === 0) {\n        cachedUint8Memory0 = new Uint8Array(wasm.memory.buffer);\n    }\n    return cachedUint8Memory0;\n}\n\nfunction getStringFromWasm0(ptr, len) {\n    ptr = ptr >>> 0;\n    return cachedTextDecoder.decode(getUint8Memory0().subarray(ptr, ptr + len));\n}\n\nconst heap = new Array(128).fill(undefined);\n\nheap.push(undefined, null, true, false);\n\nlet heap_next = heap.length;\n\nfunction addHeapObject(obj) {\n    if (heap_next === heap.length) heap.push(heap.length + 1);\n    const idx = heap_next;\n    heap_next = heap[idx];\n\n    heap[idx] = obj;\n    return idx;\n}\n\nfunction getObject(idx) { return heap[idx]; }\n\nfunction dropObject(idx) {\n    if (idx < 132) return;\n    heap[idx] = heap_next;\n    heap_next = idx;\n}\n\nfunction takeObject(idx) {\n    const ret = getObject(idx);\n    dropObject(idx);\n    return ret;\n}\n\nlet cachedInt32Memory0 = null;\n\nfunction getInt32Memory0() {\n    if (cachedInt32Memory0 === null || cachedInt32Memory0.byteLength === 0) {\n        cachedInt32Memory0 = new Int32Array(wasm.memory.buffer);\n    }\n    return cachedInt32Memory0;\n}\n\nfunction getArrayU8FromWasm0(ptr, len) {\n    ptr = ptr >>> 0;\n    return getUint8Memory0().subarray(ptr / 1, ptr / 1 + len);\n}\n\nlet WASM_VECTOR_LEN = 0;\n\nconst cachedTextEncoder = (typeof TextEncoder !== 'undefined' ? new TextEncoder('utf-8') : { encode: () => { throw Error('TextEncoder not available') } } );\n\nconst encodeString = (typeof cachedTextEncoder.encodeInto === 'function'\n    ? function (arg, view) {\n    return cachedTextEncoder.encodeInto(arg, view);\n}\n    : function (arg, view) {\n    const buf = cachedTextEncoder.encode(arg);\n    view.set(buf);\n    return {\n        read: arg.length,\n        written: buf.length\n    };\n});\n\nfunction passStringToWasm0(arg, malloc, realloc) {\n\n    if (realloc === undefined) {\n        const buf = cachedTextEncoder.encode(arg);\n        const ptr = malloc(buf.length, 1) >>> 0;\n        getUint8Memory0().subarray(ptr, ptr + buf.length).set(buf);\n        WASM_VECTOR_LEN = buf.length;\n        return ptr;\n    }\n\n    let len = arg.length;\n    let ptr = malloc(len, 1) >>> 0;\n\n    const mem = getUint8Memory0();\n\n    let offset = 0;\n\n    for (; offset < len; offset++) {\n        const code = arg.charCodeAt(offset);\n        if (code > 0x7F) break;\n        mem[ptr + offset] = code;\n    }\n\n    if (offset !== len) {\n        if (offset !== 0) {\n            arg = arg.slice(offset);\n        }\n        ptr = realloc(ptr, len, len = offset + arg.length * 3, 1) >>> 0;\n        const view = getUint8Memory0().subarray(ptr + offset, ptr + len);\n        const ret = encodeString(arg, view);\n\n        offset += ret.written;\n    }\n\n    WASM_VECTOR_LEN = offset;\n    return ptr;\n}\n\nfunction handleError(f, args) {\n    try {\n        return f.apply(this, args);\n    } catch (e) {\n        wasm.__wbindgen_exn_store(addHeapObject(e));\n    }\n}\n/**\n*/\nexport class Game {\n\n    static __wrap(ptr) {\n        ptr = ptr >>> 0;\n        const obj = Object.create(Game.prototype);\n        obj.__wbg_ptr = ptr;\n\n        return obj;\n    }\n\n    __destroy_into_raw() {\n        const ptr = this.__wbg_ptr;\n        this.__wbg_ptr = 0;\n\n        return ptr;\n    }\n\n    free() {\n        const ptr = this.__destroy_into_raw();\n        wasm.__wbg_game_free(ptr);\n    }\n    /**\n    * @returns {Game}\n    */\n    static new() {\n        const ret = wasm.game_new();\n        return Game.__wrap(ret);\n    }\n    /**\n    * @returns {boolean}\n    */\n    is_drafting() {\n        const ret = wasm.game_is_drafting(this.__wbg_ptr);\n        return ret !== 0;\n    }\n    /**\n    * @returns {boolean}\n    */\n    finished_drafting() {\n        const ret = wasm.game_finished_drafting(this.__wbg_ptr);\n        return ret !== 0;\n    }\n    /**\n    * @returns {boolean}\n    */\n    game_over() {\n        const ret = wasm.game_game_over(this.__wbg_ptr);\n        return ret !== 0;\n    }\n    /**\n    * @returns {number | undefined}\n    */\n    active_player() {\n        const ret = wasm.game_active_player(this.__wbg_ptr);\n        return ret === 0xFFFFFF ? undefined : ret;\n    }\n    /**\n    * @param {number} player\n    * @returns {number}\n    */\n    score(player) {\n        const ret = wasm.game_score(this.__wbg_ptr, player);\n        return ret >>> 0;\n    }\n    /**\n    * @returns {number}\n    */\n    turn() {\n        const ret = wasm.game_turn(this.__wbg_ptr);\n        return ret >>> 0;\n    }\n    /**\n    * @param {number} idx\n    * @returns {number}\n    */\n    num_fish(idx) {\n        const ret = wasm.game_num_fish(this.__wbg_ptr, idx);\n        return ret >>> 0;\n    }\n    /**\n    * @param {number} player\n    * @returns {Uint8Array}\n    */\n    penguins(player) {\n        try {\n            const retptr = wasm.__wbindgen_add_to_stack_pointer(-16);\n            wasm.game_penguins(retptr, this.__wbg_ptr, player);\n            var r0 = getInt32Memory0()[retptr / 4 + 0];\n            var r1 = getInt32Memory0()[retptr / 4 + 1];\n            var v1 = getArrayU8FromWasm0(r0, r1).slice();\n            wasm.__wbindgen_free(r0, r1 * 1);\n            return v1;\n        } finally {\n            wasm.__wbindgen_add_to_stack_pointer(16);\n        }\n    }\n    /**\n    * @param {number} player\n    * @returns {Uint8Array}\n    */\n    claimed(player) {\n        try {\n            const retptr = wasm.__wbindgen_add_to_stack_pointer(-16);\n            wasm.game_claimed(retptr, this.__wbg_ptr, player);\n            var r0 = getInt32Memory0()[retptr / 4 + 0];\n            var r1 = getInt32Memory0()[retptr / 4 + 1];\n            var v1 = getArrayU8FromWasm0(r0, r1).slice();\n            wasm.__wbindgen_free(r0, r1 * 1);\n            return v1;\n        } finally {\n            wasm.__wbindgen_add_to_stack_pointer(16);\n        }\n    }\n    /**\n    * @returns {Uint8Array}\n    */\n    draftable_cells() {\n        try {\n            const retptr = wasm.__wbindgen_add_to_stack_pointer(-16);\n            wasm.game_draftable_cells(retptr, this.__wbg_ptr);\n            var r0 = getInt32Memory0()[retptr / 4 + 0];\n            var r1 = getInt32Memory0()[retptr / 4 + 1];\n            var v1 = getArrayU8FromWasm0(r0, r1).slice();\n            wasm.__wbindgen_free(r0, r1 * 1);\n            return v1;\n        } finally {\n            wasm.__wbindgen_add_to_stack_pointer(16);\n        }\n    }\n    /**\n    * @param {number} src\n    * @returns {Uint8Array}\n    */\n    possible_moves(src) {\n        try {\n            const retptr = wasm.__wbindgen_add_to_stack_pointer(-16);\n            wasm.game_possible_moves(retptr, this.__wbg_ptr, src);\n            var r0 = getInt32Memory0()[retptr / 4 + 0];\n            var r1 = getInt32Memory0()[retptr / 4 + 1];\n            var v1 = getArrayU8FromWasm0(r0, r1).slice();\n            wasm.__wbindgen_free(r0, r1 * 1);\n            return v1;\n        } finally {\n            wasm.__wbindgen_add_to_stack_pointer(16);\n        }\n    }\n    /**\n    * @param {number} dst\n    */\n    place_penguin(dst) {\n        try {\n            const retptr = wasm.__wbindgen_add_to_stack_pointer(-16);\n            wasm.game_place_penguin(retptr, this.__wbg_ptr, dst);\n            var r0 = getInt32Memory0()[retptr / 4 + 0];\n            var r1 = getInt32Memory0()[retptr / 4 + 1];\n            if (r1) {\n                throw takeObject(r0);\n            }\n        } finally {\n            wasm.__wbindgen_add_to_stack_pointer(16);\n        }\n    }\n    /**\n    * @param {number} src\n    * @param {number} dst\n    */\n    move_penguin(src, dst) {\n        try {\n            const retptr = wasm.__wbindgen_add_to_stack_pointer(-16);\n            wasm.game_move_penguin(retptr, this.__wbg_ptr, src, dst);\n            var r0 = getInt32Memory0()[retptr / 4 + 0];\n            var r1 = getInt32Memory0()[retptr / 4 + 1];\n            if (r1) {\n                throw takeObject(r0);\n            }\n        } finally {\n            wasm.__wbindgen_add_to_stack_pointer(16);\n        }\n    }\n    /**\n    */\n    playout() {\n        wasm.game_playout(this.__wbg_ptr);\n    }\n    /**\n    * @returns {number}\n    */\n    get_visits() {\n        const ret = wasm.game_get_visits(this.__wbg_ptr);\n        return ret;\n    }\n    /**\n    *\n    *     * Number of times we've tried and won by placing a penguin at `dst` on the current board\n    *\n    * @param {number} dst\n    * @returns {MoveInfo}\n    */\n    place_info(dst) {\n        const ret = wasm.game_place_info(this.__wbg_ptr, dst);\n        return MoveInfo.__wrap(ret);\n    }\n    /**\n    *\n    *     * Number of times we've tried and won by moving a penguin from `src` to `dst` on the current\n    *     * board\n    *\n    * @param {number} src\n    * @param {number} dst\n    * @returns {MoveInfo}\n    */\n    move_info(src, dst) {\n        const ret = wasm.game_move_info(this.__wbg_ptr, src, dst);\n        return MoveInfo.__wrap(ret);\n    }\n    /**\n    */\n    take_action() {\n        try {\n            const retptr = wasm.__wbindgen_add_to_stack_pointer(-16);\n            wasm.game_take_action(retptr, this.__wbg_ptr);\n            var r0 = getInt32Memory0()[retptr / 4 + 0];\n            var r1 = getInt32Memory0()[retptr / 4 + 1];\n            if (r1) {\n                throw takeObject(r0);\n            }\n        } finally {\n            wasm.__wbindgen_add_to_stack_pointer(16);\n        }\n    }\n}\n/**\n*/\nexport class MoveInfo {\n\n    static __wrap(ptr) {\n        ptr = ptr >>> 0;\n        const obj = Object.create(MoveInfo.prototype);\n        obj.__wbg_ptr = ptr;\n\n        return obj;\n    }\n\n    __destroy_into_raw() {\n        const ptr = this.__wbg_ptr;\n        this.__wbg_ptr = 0;\n\n        return ptr;\n    }\n\n    free() {\n        const ptr = this.__destroy_into_raw();\n        wasm.__wbg_moveinfo_free(ptr);\n    }\n    /**\n    * @returns {number}\n    */\n    get_visits() {\n        const ret = wasm.moveinfo_get_visits(this.__wbg_ptr);\n        return ret;\n    }\n    /**\n    * @returns {number}\n    */\n    get_rewards() {\n        const ret = wasm.moveinfo_get_rewards(this.__wbg_ptr);\n        return ret;\n    }\n}\n\nasync function __wbg_load(module, imports) {\n    if (typeof Response === 'function' && module instanceof Response) {\n        if (typeof WebAssembly.instantiateStreaming === 'function') {\n            try {\n                return await WebAssembly.instantiateStreaming(module, imports);\n\n            } catch (e) {\n                if (module.headers.get('Content-Type') != 'application/wasm') {\n                    console.warn(\"`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\\n\", e);\n\n                } else {\n                    throw e;\n                }\n            }\n        }\n\n        const bytes = await module.arrayBuffer();\n        return await WebAssembly.instantiate(bytes, imports);\n\n    } else {\n        const instance = await WebAssembly.instantiate(module, imports);\n\n        if (instance instanceof WebAssembly.Instance) {\n            return { instance, module };\n\n        } else {\n            return instance;\n        }\n    }\n}\n\nfunction __wbg_get_imports() {\n    const imports = {};\n    imports.wbg = {};\n    imports.wbg.__wbindgen_string_new = function(arg0, arg1) {\n        const ret = getStringFromWasm0(arg0, arg1);\n        return addHeapObject(ret);\n    };\n    imports.wbg.__wbg_new_abda76e883ba8a5f = function() {\n        const ret = new Error();\n        return addHeapObject(ret);\n    };\n    imports.wbg.__wbg_stack_658279fe44541cf6 = function(arg0, arg1) {\n        const ret = getObject(arg1).stack;\n        const ptr1 = passStringToWasm0(ret, wasm.__wbindgen_malloc, wasm.__wbindgen_realloc);\n        const len1 = WASM_VECTOR_LEN;\n        getInt32Memory0()[arg0 / 4 + 1] = len1;\n        getInt32Memory0()[arg0 / 4 + 0] = ptr1;\n    };\n    imports.wbg.__wbg_error_f851667af71bcfc6 = function(arg0, arg1) {\n        let deferred0_0;\n        let deferred0_1;\n        try {\n            deferred0_0 = arg0;\n            deferred0_1 = arg1;\n            console.error(getStringFromWasm0(arg0, arg1));\n        } finally {\n            wasm.__wbindgen_free(deferred0_0, deferred0_1, 1);\n        }\n    };\n    imports.wbg.__wbindgen_object_drop_ref = function(arg0) {\n        takeObject(arg0);\n    };\n    imports.wbg.__wbg_getRandomValues_37fa2ca9e4e07fab = function() { return handleError(function (arg0, arg1) {\n        getObject(arg0).getRandomValues(getObject(arg1));\n    }, arguments) };\n    imports.wbg.__wbg_randomFillSync_dc1e9a60c158336d = function() { return handleError(function (arg0, arg1) {\n        getObject(arg0).randomFillSync(takeObject(arg1));\n    }, arguments) };\n    imports.wbg.__wbg_crypto_c48a774b022d20ac = function(arg0) {\n        const ret = getObject(arg0).crypto;\n        return addHeapObject(ret);\n    };\n    imports.wbg.__wbindgen_is_object = function(arg0) {\n        const val = getObject(arg0);\n        const ret = typeof(val) === 'object' && val !== null;\n        return ret;\n    };\n    imports.wbg.__wbg_process_298734cf255a885d = function(arg0) {\n        const ret = getObject(arg0).process;\n        return addHeapObject(ret);\n    };\n    imports.wbg.__wbg_versions_e2e78e134e3e5d01 = function(arg0) {\n        const ret = getObject(arg0).versions;\n        return addHeapObject(ret);\n    };\n    imports.wbg.__wbg_node_1cd7a5d853dbea79 = function(arg0) {\n        const ret = getObject(arg0).node;\n        return addHeapObject(ret);\n    };\n    imports.wbg.__wbindgen_is_string = function(arg0) {\n        const ret = typeof(getObject(arg0)) === 'string';\n        return ret;\n    };\n    imports.wbg.__wbg_msCrypto_bcb970640f50a1e8 = function(arg0) {\n        const ret = getObject(arg0).msCrypto;\n        return addHeapObject(ret);\n    };\n    imports.wbg.__wbg_require_8f08ceecec0f4fee = function() { return handleError(function () {\n        const ret = module.require;\n        return addHeapObject(ret);\n    }, arguments) };\n    imports.wbg.__wbindgen_is_function = function(arg0) {\n        const ret = typeof(getObject(arg0)) === 'function';\n        return ret;\n    };\n    imports.wbg.__wbg_newnoargs_581967eacc0e2604 = function(arg0, arg1) {\n        const ret = new Function(getStringFromWasm0(arg0, arg1));\n        return addHeapObject(ret);\n    };\n    imports.wbg.__wbg_call_cb65541d95d71282 = function() { return handleError(function (arg0, arg1) {\n        const ret = getObject(arg0).call(getObject(arg1));\n        return addHeapObject(ret);\n    }, arguments) };\n    imports.wbg.__wbindgen_object_clone_ref = function(arg0) {\n        const ret = getObject(arg0);\n        return addHeapObject(ret);\n    };\n    imports.wbg.__wbg_self_1ff1d729e9aae938 = function() { return handleError(function () {\n        const ret = self.self;\n        return addHeapObject(ret);\n    }, arguments) };\n    imports.wbg.__wbg_window_5f4faef6c12b79ec = function() { return handleError(function () {\n        const ret = window.window;\n        return addHeapObject(ret);\n    }, arguments) };\n    imports.wbg.__wbg_globalThis_1d39714405582d3c = function() { return handleError(function () {\n        const ret = globalThis.globalThis;\n        return addHeapObject(ret);\n    }, arguments) };\n    imports.wbg.__wbg_global_651f05c6a0944d1c = function() { return handleError(function () {\n        const ret = global.global;\n        return addHeapObject(ret);\n    }, arguments) };\n    imports.wbg.__wbindgen_is_undefined = function(arg0) {\n        const ret = getObject(arg0) === undefined;\n        return ret;\n    };\n    imports.wbg.__wbg_call_01734de55d61e11d = function() { return handleError(function (arg0, arg1, arg2) {\n        const ret = getObject(arg0).call(getObject(arg1), getObject(arg2));\n        return addHeapObject(ret);\n    }, arguments) };\n    imports.wbg.__wbg_buffer_085ec1f694018c4f = function(arg0) {\n        const ret = getObject(arg0).buffer;\n        return addHeapObject(ret);\n    };\n    imports.wbg.__wbg_newwithbyteoffsetandlength_6da8e527659b86aa = function(arg0, arg1, arg2) {\n        const ret = new Uint8Array(getObject(arg0), arg1 >>> 0, arg2 >>> 0);\n        return addHeapObject(ret);\n    };\n    imports.wbg.__wbg_new_8125e318e6245eed = function(arg0) {\n        const ret = new Uint8Array(getObject(arg0));\n        return addHeapObject(ret);\n    };\n    imports.wbg.__wbg_set_5cf90238115182c3 = function(arg0, arg1, arg2) {\n        getObject(arg0).set(getObject(arg1), arg2 >>> 0);\n    };\n    imports.wbg.__wbg_newwithlength_e5d69174d6984cd7 = function(arg0) {\n        const ret = new Uint8Array(arg0 >>> 0);\n        return addHeapObject(ret);\n    };\n    imports.wbg.__wbg_subarray_13db269f57aa838d = function(arg0, arg1, arg2) {\n        const ret = getObject(arg0).subarray(arg1 >>> 0, arg2 >>> 0);\n        return addHeapObject(ret);\n    };\n    imports.wbg.__wbindgen_throw = function(arg0, arg1) {\n        throw new Error(getStringFromWasm0(arg0, arg1));\n    };\n    imports.wbg.__wbindgen_memory = function() {\n        const ret = wasm.memory;\n        return addHeapObject(ret);\n    };\n\n    return imports;\n}\n\nfunction __wbg_init_memory(imports, maybe_memory) {\n\n}\n\nfunction __wbg_finalize_init(instance, module) {\n    wasm = instance.exports;\n    __wbg_init.__wbindgen_wasm_module = module;\n    cachedInt32Memory0 = null;\n    cachedUint8Memory0 = null;\n\n\n    return wasm;\n}\n\nfunction initSync(module) {\n    if (wasm !== undefined) return wasm;\n\n    const imports = __wbg_get_imports();\n\n    __wbg_init_memory(imports);\n\n    if (!(module instanceof WebAssembly.Module)) {\n        module = new WebAssembly.Module(module);\n    }\n\n    const instance = new WebAssembly.Instance(module, imports);\n\n    return __wbg_finalize_init(instance, module);\n}\n\nasync function __wbg_init(input) {\n    if (wasm !== undefined) return wasm;\n\n    if (typeof input === 'undefined') {\n        input = new URL('htmf_wasm_bg.wasm', import.meta.url);\n    }\n    const imports = __wbg_get_imports();\n\n    if (typeof input === 'string' || (typeof Request === 'function' && input instanceof Request) || (typeof URL === 'function' && input instanceof URL)) {\n        input = fetch(input);\n    }\n\n    __wbg_init_memory(imports);\n\n    const { instance, module } = await __wbg_load(await input, imports);\n\n    return __wbg_finalize_init(instance, module);\n}\n\nexport { initSync }\nexport default __wbg_init;\n","const NPLAYERS = 2\nconst HUMAN_PLAYER = 0\nconst BOT_PLAYER = 1\nconst NUM_ROWS = 8\nconst EVEN_ROW_LEN = 7\nconst ODD_ROW_LEN = 8\nconst NUM_CELLS = EVEN_ROW_LEN * (NUM_ROWS / 2) + ODD_ROW_LEN * (NUM_ROWS / 2)\n\nconst PLAYOUT_MS = 100\nconst PONDER_INTERVAL_MS = 0\nconst MIN_PLAYOUTS = 14_000\nconst MAX_PLAYOUTS = 60_000\n\nexport {\n  NPLAYERS,\n  HUMAN_PLAYER,\n  BOT_PLAYER,\n  NUM_ROWS,\n  EVEN_ROW_LEN,\n  ODD_ROW_LEN,\n  NUM_CELLS,\n  PLAYOUT_MS,\n  MIN_PLAYOUTS,\n  MAX_PLAYOUTS,\n  PONDER_INTERVAL_MS\n}\n","import * as wasm from 'htmf-wasm'\n\nimport { NPLAYERS, NUM_CELLS, PLAYOUT_MS, PONDER_INTERVAL_MS, MIN_PLAYOUTS, MAX_PLAYOUTS, HUMAN_PLAYER } from './constants'\nimport type GameState from './GameState'\nimport { type WorkerRequest, type WorkerResponse } from './WorkerProtocol'\n\nfunction getGameState (game: wasm.Game): GameState {\n  const fish = []\n  for (let idx = 0; idx < NUM_CELLS; ++idx) {\n    fish.push(game.num_fish(idx))\n  }\n  const scores: number[] = []\n  const penguins = []\n  const claimed = []\n  for (let p = 0; p < NPLAYERS; ++p) {\n    scores.push(game.score(p))\n    penguins.push([...game.penguins(p)])\n    claimed.push([...game.claimed(p)])\n  }\n  return {\n    activePlayer: game.active_player(),\n    modeType: game.finished_drafting() ? 'playing' : 'drafting',\n    scores,\n    turn: game.turn(),\n    board: {\n      fish,\n      penguins,\n      claimed\n    }\n  }\n}\n\nfunction getPossibleMoves (game: wasm.Game, src?: number): number[] {\n  if (game.active_player() !== HUMAN_PLAYER) {\n    return []\n  }\n  if (game.finished_drafting()) {\n    if (src !== undefined) {\n      return [...game.possible_moves(src)]\n    }\n    const activePlayer = game.active_player()\n    return activePlayer === undefined ? [] : [...game.penguins(activePlayer)]\n  } else {\n    return [...game.draftable_cells()]\n  }\n}\n\nclass Bot {\n  game: wasm.Game\n  postMessage: (msg: WorkerResponse) => void\n  ponderer?: number\n  nplayouts = 0\n\n  constructor (postMessage: (msg: WorkerResponse) => void) {\n    this.game = wasm.Game.new()\n    this.postMessage = postMessage\n    this.ponder()\n  }\n\n  free (): void {\n    this.stopPondering()\n    this.game.free()\n  }\n\n  init (): void {\n    const postMessage = this.postMessage\n    postMessage({\n      type: 'initialized',\n      gameState: this.getState(),\n      possibleMoves: this.getPossibleMoves()\n    })\n  }\n\n  ponder (): void {\n    this.nplayouts = this.game.get_visits()\n\n    if (this.ponderer !== undefined) {\n      return\n    }\n    this.ponderer = setInterval(\n      () => {\n        if (this.nplayouts >= MAX_PLAYOUTS) {\n          this.stopPondering()\n          return\n        }\n        const t0 = performance.now()\n        while (performance.now() - t0 < PLAYOUT_MS) {\n          this.playout()\n        }\n\n        const activePlayer = this.game.active_player()\n        if (activePlayer !== undefined) {\n          if (this.game.is_drafting()) {\n            this.postPlaceScores(activePlayer)\n          } else {\n            this.postMoveScores(activePlayer)\n          }\n        }\n      },\n      PONDER_INTERVAL_MS\n    )\n  }\n\n  stopPondering (): void {\n    if (this.ponderer !== undefined) {\n      clearInterval(this.ponderer)\n      this.ponderer = undefined\n    }\n  }\n\n  placePenguin (dst: number): void {\n    this.game.place_penguin(dst)\n    this.ponder()\n  }\n\n  movePenguin (src: number, dst: number): void {\n    this.game.move_penguin(src, dst)\n    this.ponder()\n  }\n\n  playout (): void {\n    this.game.playout()\n    ++this.nplayouts\n  }\n\n  takeAction (): void {\n    this.stopPondering()\n    const postMessage = this.postMessage\n    const minPlayouts = this.game.turn() < 2 ? 2 * MIN_PLAYOUTS : MIN_PLAYOUTS\n    while (this.nplayouts < minPlayouts) {\n      this.playout()\n      if (this.nplayouts % 100 === 0) {\n        postMessage({\n          type: 'thinkingProgress',\n          completed: this.nplayouts,\n          required: minPlayouts\n        })\n      }\n    }\n    this.game.take_action()\n    this.ponder()\n  }\n\n  getState (): GameState {\n    return getGameState(this.game)\n  }\n\n  getPossibleMoves (src?: number): number[] {\n    return getPossibleMoves(this.game, src)\n  }\n\n  onMessage (request: WorkerRequest): void {\n    console.log(`received request ${request.type}`)\n    switch (request.type) {\n      case 'get':\n        this.postGameState()\n        break\n      case 'move':\n        try {\n          this.movePenguin(request.src, request.dst)\n          this.postGameState()\n        } catch (err) {\n          this.postIllegalMove(request.src, request.dst)\n        }\n        break\n      case 'place':\n        try {\n          this.placePenguin(request.dst)\n          this.postGameState()\n        } catch (err) {\n          this.postIllegalPlacement(request.dst)\n        }\n        break\n      case 'possibleMoves':\n        this.postPossibleMoves(request.src)\n        break\n      case 'takeAction':\n        this.takeAction()\n        this.postGameState()\n        break\n    }\n  }\n\n  postIllegalMove (src: number, dst: number): void {\n    const postMessage = this.postMessage\n    postMessage({\n      type: 'illegalMove',\n      src,\n      dst\n    })\n  }\n\n  postIllegalPlacement (dst: number): void {\n    const postMessage = this.postMessage\n    postMessage({\n      type: 'illegalPlacement',\n      dst\n    })\n  }\n\n  postPossibleMoves (src?: number): void {\n    const postMessage = this.postMessage\n    postMessage({\n      type: 'possibleMoves',\n      possibleMoves: this.getPossibleMoves(src)\n    })\n  }\n\n  postGameState (): void {\n    const postMessage = this.postMessage\n    postMessage({\n      type: 'state',\n      gameState: this.getState()\n    })\n  }\n\n  postPlaceScores (activePlayer: number): void {\n    const placeScores = []\n    for (const dst of this.game.draftable_cells()) {\n      const info = this.game.place_info(dst)\n      placeScores.push({\n        dst,\n        visits: info.get_visits(),\n        rewards: info.get_rewards()\n      })\n    }\n    const postMessage = this.postMessage\n    postMessage({\n      type: 'placeScores',\n      activePlayer,\n      placeScores\n    })\n  }\n\n  postMoveScores (activePlayer: number): void {\n    const moveScores = []\n    for (const src of this.game.penguins(activePlayer)) {\n      for (const dst of this.game.possible_moves(src)) {\n        const info = this.game.move_info(src, dst)\n        moveScores.push({\n          src,\n          dst,\n          visits: info.get_visits(),\n          rewards: info.get_rewards()\n        })\n      }\n    }\n    const postMessage = this.postMessage\n    postMessage({\n      type: 'moveScores',\n      activePlayer,\n      moveScores\n    })\n  }\n}\n\nexport default Bot\n","import Bot from './Bot'\nimport __wbg_init from 'htmf-wasm'\n\n// Run WebAssembly.instantiateStreaming() to load and initialize the WebAssembly module\nawait __wbg_init()\n\nconst bot = new Bot(postMessage)\nonmessage = (event) => {\n  bot.onMessage(event.data)\n}\nbot.init()\n\nexport { }\n"],"names":["wasm","cachedTextDecoder","cachedUint8Memory0","getUint8Memory0","getStringFromWasm0","ptr","len","heap","heap_next","addHeapObject","obj","idx","getObject","dropObject","takeObject","ret","cachedInt32Memory0","getInt32Memory0","getArrayU8FromWasm0","WASM_VECTOR_LEN","cachedTextEncoder","encodeString","arg","view","buf","passStringToWasm0","malloc","realloc","mem","offset","code","handleError","f","args","e","Game","player","retptr","r0","r1","v1","src","dst","MoveInfo","__wbg_load","module","imports","bytes","instance","__wbg_get_imports","arg0","arg1","ptr1","len1","deferred0_0","deferred0_1","val","arg2","__wbg_finalize_init","__wbg_init","input","NPLAYERS","HUMAN_PLAYER","NUM_ROWS","EVEN_ROW_LEN","ODD_ROW_LEN","NUM_CELLS","PLAYOUT_MS","PONDER_INTERVAL_MS","MIN_PLAYOUTS","MAX_PLAYOUTS","getGameState","game","fish","scores","penguins","claimed","p","getPossibleMoves","activePlayer","Bot","postMessage","wasm.Game","t0","minPlayouts","request","placeScores","info","moveScores","bot","event"],"mappings":"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"}