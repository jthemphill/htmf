(self.webpackChunkhtmf=self.webpackChunkhtmf||[]).push([[838],{838:(e,t,s)=>{"use strict";s.r(t);var a=s(294),l=s(935);const n=["blue","red","orange","green"],i=a.memo((function(e){let t=void 0;0==e.player?t="human":1==e.player&&(t="bot");const s="penguin "+t,l=e.size/500;return a.createElement("g",{transform:`scale(${l}),translate(-307.62496,-350)`},a.createElement("g",{transform:"matrix(2.0165499,0,0,2.0165499,-378.20444,-374.28247)"},a.createElement("g",{transform:"translate(0,-14)",className:"penguin leftFoot"},a.createElement("rect",{className:"penguin foot",width:"18.182745",height:"72.73098",x:"340.37064",y:"378.86526"}),a.createElement("path",{className:"penguin foot",d:"m 347.12481,446.95339 -60.42857,21.85714 45.71428,18.57143 26.14286,-35.78572 z"})),a.createElement("g",{transform:"matrix(-1,0,0,1,745.35258,-14)",className:"penguin rightFoot"},a.createElement("rect",{y:"378.86526",x:"340.37064",height:"72.73098",width:"18.182745",className:"penguin foot"}),a.createElement("path",{d:"m 347.12481,446.95339 -60.42857,21.85714 45.71428,18.57143 26.14286,-35.78572 z",className:"penguin foot"})),a.createElement("path",{transform:"matrix(0.59003831,0,0,0.59003831,186.08628,108.73722)",d:"m 446.48743,416.47116 c 0,72.80489 -58.79389,131.82491 -131.31983,131.82491 -72.52593,0 -131.31982,-59.02002 -131.31982,-131.82491 0,-72.80488 58.79389,-131.8249 131.31982,-131.8249 72.52594,0 131.31983,59.02002 131.31983,131.8249 z",className:s}),a.createElement("path",{transform:"translate(59.910095,0)",d:"m 361.63462,289.69702 c 0,27.3367 -22.16077,49.49748 -49.49747,49.49748 -27.3367,0 -49.49748,-22.16078 -49.49748,-49.49748 0,-27.3367 22.16078,-49.49747 49.49748,-49.49747 27.3367,0 49.49747,22.16077 49.49747,49.49747 z",className:s}),a.createElement("path",{d:"m 345.78328,275.11088 c 0,0 6.9297,-6 26.26396,-6 19.33426,0 26.26397,6 26.26397,6 l -26.26397,52.52793 z",className:"penguin beak"}),a.createElement("path",{transform:"translate(0,-8)",className:"penguin eyes",d:"m 369.46331,266.71603 c 0,5.43945 -4.40955,9.84899 -9.84899,9.84899 -5.43945,0 -9.84899,-4.40954 -9.84899,-9.84899 0,-5.43944 4.40954,-9.84898 9.84899,-9.84898 5.43944,0 9.84899,4.40954 9.84899,9.84898 z"}),a.createElement("path",{transform:"translate(0,-8)",d:"m 391.93917,269.36768 c 0,3.55656 -2.88316,6.43972 -6.43972,6.43972 -3.55656,0 -6.43972,-2.88316 -6.43972,-6.43972 0,-3.55656 2.88316,-6.43973 6.43972,-6.43973 3.55656,0 6.43972,2.88317 6.43972,6.43973 z",className:"penguin eyes"}),a.createElement("path",{d:"M 332.14074,297.03867 247.29889,260.5461 c 10.94712,32.37883 32.49618,64.01962 75.63693,75.93783 z",className:s}),a.createElement("path",{className:s,d:"M 411.95375,297.03867 496.7956,260.5461 c -10.94712,32.37883 -32.49618,64.01962 -75.63693,75.93783 z"})))}));function o(e){const t=[];for(let s=0;s<6;++s)t.push(c(e,s));return t}function c(e,t){const s=e.sideLength,a=t*Math.PI/3;return[s*Math.sin(a),s*Math.cos(a)]}const r=a.memo((function(e){const t=`translate(${e.cx},${e.cy})`,s=e.player;if(null==s&&e.claimed)return a.createElement("g",{transform:t},a.createElement("polygon",{points:o(e).join(" "),className:"cell claimed"}));let l=null,n=null;null!=s?l=a.createElement(i,{player:s,size:e.sideLength}):n=function(e){const t=e.sideLength/10;if(1===e.fish)return[a.createElement("circle",{key:0,className:"fish",r:t})];if(2===e.fish)return[a.createElement("circle",{key:0,className:"fish",cx:2*-t,r:t}),a.createElement("circle",{key:1,className:"fish",cx:2*t,r:t})];if(3===e.fish){const e=2*t*Math.sin(Math.PI/3);return[a.createElement("circle",{key:0,className:"fish",cx:2*-t,cy:e,r:t}),a.createElement("circle",{key:1,className:"fish",cx:2*t,cy:e,r:t}),a.createElement("circle",{key:2,className:"fish",cx:0,cy:-e,r:t})]}throw new Error(e.fish+" is not a valid fish amount")}(e);const c=["cell"];return e.highlighted?c.push("highlighted"):e.possible&&c.push("possible"),a.createElement("g",{transform:t,onClick:()=>e.onClick(e._key)},a.createElement("polygon",{className:c.join(" "),points:o(e).join(" ")}),n,l)})),h=a.memo((function(e){const t=62.5,s=new Map;for(let t of[0,1])for(let a of e.gameState.board.penguins[t])s.set(a,t);const l=e.possibleMoves.length>0,n=new Set([]);for(let t of e.gameState.board.claimed)for(let e of t)n.add(e);const i=[];for(let o=0;o<8;++o){const c=125+1.5*o*t,h=o%2==0?7:8,m=o%2*-1*Math.sqrt(3)*t/2;for(let o=0;o<h;++o){const h=125+o*(t*(Math.sin(Math.PI/3)-Math.sin(5*Math.PI/3)))+m,p=i.length,g=e.gameState.board.fish[p],d=e.possibleMoves.includes(p),u=l&&e.chosenCell===p;i.push(a.createElement(r,{key:p,_key:p,onClick:e.handleCellClick,fish:g,cx:h,cy:c,sideLength:t,highlighted:u,possible:d,player:s.get(p),claimed:n.has(p)}))}}return a.createElement("svg",{version:"1.1",baseProfile:"full",xmlns:"http://www.w3.org/2000/svg",className:"board",viewBox:"0 0 1000 1000"},i)}));class m extends a.Component{constructor(e){super(e),this.handleCellClick=this._handleCellClick.bind(this),this.worker=new Worker(new URL(s.p+s.u(380),s.b)),this.worker.onmessage=this.onMessage.bind(this),this.state={}}activePlayer(){var e;return null===(e=this.state.gameState)||void 0===e?void 0:e.activePlayer}render(){var e,t;const s=this.state.lastMoveInvalid?"Invalid move!":null,l=[],i=this.activePlayer();for(let t=0;t<2;++t){let s={color:n[t]},o=i===t?"(Active Player)":null;l.push(a.createElement("p",{key:"score_"+t},a.createElement("span",{style:s},"Score: ",null===(e=this.state.gameState)||void 0===e?void 0:e.scores[t]," ",o)))}let o=null;return this.state.gameState&&(o=a.createElement(h,{gameState:this.state.gameState,possibleMoves:this.state.possibleMoves||[],chosenCell:this.state.chosenCell,handleCellClick:this.handleCellClick})),a.createElement("div",{className:"app"},o,a.createElement("div",{className:"info-col"},a.createElement("p",null,null===(t=this.state.gameState)||void 0===t?void 0:t.modeType),a.createElement("p",null,s),a.createElement("div",null,l)))}componentDidMount(){this.postMessage({type:"get"}),this.postMessage({type:"possibleMoves"}),this.postMessage({type:"startPondering"})}componentWillUnmount(){this.worker.terminate()}_handleCellClick(e){var t,s,a;const l=this.activePlayer();null!=l&&("drafting"!==(null===(t=this.state.gameState)||void 0===t?void 0:t.modeType)?(null===(s=this.state.gameState)||void 0===s?void 0:s.board.penguins[l].includes(e))?this._toggleCellHighlight(e):null!=this.state.chosenCell&&(null===(a=this.state.possibleMoves)||void 0===a?void 0:a.includes(e))&&this._movePenguinToCell(e):this._placePenguin(e))}postMessage(e){console.log("sent request "+e.type),this.worker.postMessage(e)}onMessage(e){const t=e.data;switch(t.type){case"possibleMoves":this.setState({possibleMoves:t.possibleMoves});break;case"state":this.setState({gameState:t.gameState}),this.postMessage({type:"possibleMoves"}),1===t.gameState.activePlayer&&this.postMessage({type:"takeAction"});break;case"illegalMove":case"illegalPlacement":this.setState({lastMoveInvalid:!0})}}_placePenguin(e){this.postMessage({type:"place",dst:e})}_movePenguinToCell(e){this.state.chosenCell&&this.postMessage({type:"move",src:this.state.chosenCell,dst:e})}_toggleCellHighlight(e){if(this.state.chosenCell===e)return this.setState({chosenCell:void 0}),void this.postMessage({type:"possibleMoves"});this.postMessage({type:"possibleMoves",src:e}),this.setState({chosenCell:e})}}l.render(a.createElement(m,null),document.getElementById("root"))}}]);